<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/component---src-templates-post-tsx.a3f47ba95bfcb7ece2a3.css">code[class*=language-],pre[class*=language-]{color:#f8f8f2;background:none;text-shadow:0 1px rgba(0,0,0,.3);font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#272822}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#f8f8f2}.namespace{opacity:.7}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#f92672}.token.boolean,.token.number{color:#ae81ff}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#a6e22e}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#f8f8f2}.token.atrule,.token.attr-value,.token.class-name,.token.function{color:#e6db74}.token.keyword{color:#66d9ef}.token.important,.token.regex{color:#fd971f}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style><meta name="generator" content="Gatsby 2.0.25"/><title data-react-helmet="true">React âš›ï¸ æ–°çš„ Context API [è½¬è½½] | Typescript Power Blog</title><meta data-react-helmet="true" name="description"/><meta data-react-helmet="true" name="image" content="https://samualle.github.io/assets/banner.jpg"/><meta data-react-helmet="true" property="og:locale" content="en_US"/><meta data-react-helmet="true" property="og:site_name" content=""/><meta data-react-helmet="true" property="og:url" content="https://samualle.github.ioreact-new-context-api"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:title" content="React âš›ï¸ æ–°çš„ Context API [è½¬è½½]"/><meta data-react-helmet="true" property="og:description"/><meta data-react-helmet="true" property="og:image" content="https://samualle.github.io/assets/banner.jpg"/><meta data-react-helmet="true" property="fb:app_id" content=""/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:creator" content=""/><meta data-react-helmet="true" name="twitter:title" content="React âš›ï¸ æ–°çš„ Context API [è½¬è½½]"/><meta data-react-helmet="true" name="twitter:url" content="https://samualle.github.io"/><meta data-react-helmet="true" name="twitter:description"/><meta data-react-helmet="true" name="twitter:image" content="https://samualle.github.io/assets/banner.jpg"/><script data-react-helmet="true" type="application/ld+json">[{"@context":"http://schema.org","@type":"BlogPosting","@id":"https://samualle.github.ioreact-new-context-api","url":"https://samualle.github.ioreact-new-context-api","name":"React âš›ï¸ æ–°çš„ Context API [è½¬è½½]","alternateName":"Typescript Power Blog - Gatsby Starter","headline":"React âš›ï¸ æ–°çš„ Context API [è½¬è½½]","image":{"@type":"ImageObject","url":"https://samualle.github.io/assets/banner.jpg"},"description":"Typescript Power Blog with big typography","datePublished":"2018.12.15","dateModified":"2018.12.15","author":{"@type":"Person","name":"Samuel Wong"},"publisher":{"@type":"Organization","name":"Samuel Wong","logo":{"@type":"ImageObject","url":"https://samualle.github.io/assets/logo.png"}},"isPartOf":"https://samualle.github.io/","mainEntityOfPage":{"@type":"WebSite","@id":"https://samualle.github.io/"}}]</script><style data-styled="huZlfA fMlwmL llYXYs kgeCvq jykKLt hQYvCd gZRmtj bmFdUH iZrggB kCgrvS eUvCXN kjXYVd fQIQbK bwMLfQ dJITlQ jbQVzl fVFvrD firMnY cXzBXX cLXdVi flGCNf" data-styled-version="4.0.0">
/* sc-component-id: Subline-sc-1don4fe-0 */
.eUvCXN{font-size:0.9rem;}.kjXYVd{font-size:0.9rem;color:rgba(255,255,255,0.7);text-align:center;}.fQIQbK{font-size:0.9rem;color:rgba(255,255,255,0.7);}
/* sc-component-id: Article__Post-r54n8f-0 */
.bmFdUH{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;margin-top:3.5rem;margin-bottom:3.5rem;}
/* sc-component-id: Article__Title-r54n8f-1 */
.iZrggB{position:relative;text-shadow:0 12px 30px rgba(0,0,0,0.15);margin-bottom:0.75rem;}
/* sc-component-id: Article__Initiale-r54n8f-2 */
.kCgrvS{position:absolute;font-size:7rem;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);opacity:0.08;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:-1;}
/* sc-component-id: Article__Excerpt-r54n8f-3 */
.bwMLfQ{grid-column:-1 / 1;margin-top:1rem;margin-bottom:1rem;}
/* sc-component-id: Header__HeaderWrapper-sc-1pk7kz9-0 */
.huZlfA{position:relative;background:linear-gradient( -185deg,rgba(77,190,122,0.6),rgba(26,26,26,0.8) ),url(/assets/bg.png) no-repeat;background-size:cover;padding:8rem 2rem 10rem;text-align:center;} .huZlfA::after{background:transparent url(/assets/mask.svg) no-repeat bottom left;background-size:101%;bottom:-2px;content:'';display:block;height:100%;left:0;position:absolute;width:100%;} @media (max-width:1200px){.huZlfA{padding:4rem 2rem 6rem;}} @media (max-width:600px){.huZlfA{padding:1rem 0.5rem 2rem;}}.fMlwmL{position:relative;background:linear-gradient( -185deg,rgba(77,190,122,0.6),rgba(26,26,26,0.8) ),url(/assets/bg/4.jpg) no-repeat;background-size:cover;padding:8rem 2rem 10rem;text-align:center;} .fMlwmL::after{background:transparent url(/assets/mask.svg) no-repeat bottom left;background-size:101%;bottom:-2px;content:'';display:block;height:100%;left:0;position:absolute;width:100%;} @media (max-width:1200px){.fMlwmL{padding:4rem 2rem 6rem;}} @media (max-width:600px){.fMlwmL{padding:1rem 0.5rem 2rem;}}
/* sc-component-id: Header__Content-sc-1pk7kz9-1 */
.llYXYs{position:relative;z-index:999;} .llYXYs a{color:white;} .llYXYs a:hover{opacity:0.85;color:white;}
/* sc-component-id: sc-global-69815226 */
::selection{color:#fff;background:#72cc96;} body{background:#fff;color:rgba(0,0,0,0.7);} @media (max-width:600px){body{font-size:14px;}} a{color:rgba(0,0,0,0.9);-webkit-text-decoration:none;text-decoration:none;-webkit-transition:all 0.5s;transition:all 0.5s;} a:hover{color:#72cc96;} h1,h2,h3,h4{color:rgba(0,0,0,0.9);} blockquote{font-style:italic;position:relative;} blockquote:before{content:"";position:absolute;background:#72cc96;height:100%;width:6px;margin-left:-1.6rem;} label{margin-bottom:.5rem;color:rgba(0,0,0,0.9);} input,textarea{border-radius:.5rem;border:none;background:rgba(0,0,0,0.05);padding:.25rem 1rem;} input:focus,textarea:focus{outline:none;} .textRight{text-align:right;}
/* sc-component-id: Layout__Footer-sc-1dswc3f-0 */
.fVFvrD{text-align:center;padding:3rem 0;} .fVFvrD span{font-size:0.75rem;}
/* sc-component-id: PrevNext__Wrapper-sc-1ndbygb-0 */
.cLXdVi{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:6rem auto 0 auto;justify-items:center;} .cLXdVi a{color:#72cc96;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}
/* sc-component-id: PrevNext__Prev-sc-1ndbygb-1 */
.flGCNf span{text-transform:uppercase;font-size:0.8rem;color:rgba(0,0,0,0.5);}
/* sc-component-id: SectionTitle-sc-6i07is-0 */
.kgeCvq{font-size:2.9rem;text-transform:uppercase;text-align:center;color:#fff;position:relative;padding:2rem 0 0;margin-bottom:2rem;} .kgeCvq:after{content:'';height:1px;width:50px;position:absolute;bottom:0;left:50%;margin-left:-25px;background:#fff;}.jykKLt{font-size:2.9rem;text-transform:normal;text-align:center;color:#fff;position:relative;padding:2rem 0 0;margin-bottom:2rem;} .jykKLt:after{content:'';height:1px;width:50px;position:absolute;bottom:0;left:50%;margin-left:-25px;background:#fff;}
/* sc-component-id: Wrapper-eqkv0y-0 */
.hQYvCd{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;margin:0 auto;max-width:100rem;padding:0 6rem;} @media (max-width:1200px){.hQYvCd{padding:0 3rem;}} @media (max-width:600px){.hQYvCd{padding:0 1rem;}}
/* sc-component-id: Content-b9laau-0 */
.gZRmtj{box-shadow:0 4px 120px rgba(0,0,0,0.1);border-radius:1rem;padding:2rem 4rem;background-color:#fff;z-index:9000;margin-top:-4rem;} .gZRmtj form p label,.gZRmtj form p input{display:block;} .gZRmtj form p input{min-width:275px;} .gZRmtj form p textarea{resize:vertical;min-height:150px;width:100%;} @media (max-width:1200px){.gZRmtj{padding:3rem 3rem;}} @media (max-width:600px){.gZRmtj{padding:2rem 1.5rem;}}
/* sc-component-id: Title-sc-1f755z2-0 */
.firMnY{position:relative;text-shadow:0 12px 30px rgba(0,0,0,0.15);margin-bottom:0.75rem;}
/* sc-component-id: Pagination__PaginationContainer-osdkn4-0 */
.dJITlQ{text-align:center;margin:2rem;}
/* sc-component-id: Pagination__PaginationContent-osdkn4-1 */
.jbQVzl{display:inline-block;padding:0 2.5rem;border-radius:3.5rem;background-color:#eee;} @media (max-width:600px){.jbQVzl{padding:0 1rem;}} .jbQVzl .page-numbers{display:block;float:left;-webkit-transition:400ms ease;transition:400ms ease;color:rgba(0,0,0,0.5);-webkit-letter-spacing:0.1em;-moz-letter-spacing:0.1em;-ms-letter-spacing:0.1em;letter-spacing:0.1em;padding:1rem;} .jbQVzl .page-numbers:hover,.jbQVzl .page-numbers.current{background-color:#399f62;color:#fff;} .jbQVzl .page-numbers.prev{margin-left:-1.5rem;} .jbQVzl .page-numbers.next{margin-right:-1.5rem;} .jbQVzl .page-numbers.prev:hover,.jbQVzl .page-numbers.next:hover{background-color:transparent;color:#399f62;} @media (max-width:1200px){.jbQVzl .page-numbers{padding:0 1.4rem;display:none;}.jbQVzl .page-numbers:nth-of-type(2){position:relative;padding-right:5rem;}.jbQVzl .page-numbers:nth-of-type(2)::after{content:'...';position:absolute;top:0;left:4.5rem;}.jbQVzl .page-numbers:nth-child(-n + 3),.jbQVzl .page-numbers:nth-last-child(-n + 3){display:block;}.jbQVzl .page-numbers:nth-last-child(-n + 4){padding-right:1.4rem;}.jbQVzl .page-numbers:nth-last-child(-n + 4)::after{content:none;}}
/* sc-component-id: Post__PostContent-yg6lty-0 */
.cXzBXX{margin-top:4rem;}</style><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color"/><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl+'';f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer', 'GTM-MVP42QK');</script><style type="text/css">
    .anchor {
      float: left;
      padding-right: 4px;
      margin-left: -20px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var offset = element.offsetTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:112.5%/1.66 'Open Sans',sans-serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:'Open Sans',sans-serif;font-weight:normal;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;color:inherit;font-family:'Bitter',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:3.157rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;color:inherit;font-family:'Bitter',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1.99326rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;color:inherit;font-family:'Bitter',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1.58383rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;color:inherit;font-family:'Bitter',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;color:inherit;font-family:'Bitter',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:0.79459rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;color:inherit;font-family:'Bitter',sans-serif;font-weight:700;text-rendering:optimizeLegibility;font-size:0.7083rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;}ul{margin-left:1.66rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.66rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;font-size:0.85rem;line-height:1.66rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;font-size:1rem;line-height:1.66rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;}blockquote{margin-left:1.66rem;margin-right:1.66rem;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.66rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.66rem;}b{font-weight:bold;}strong{font-weight:bold;}dt{font-weight:bold;}th{font-weight:bold;}li{margin-bottom:calc(1.66rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.66rem;margin-bottom:calc(1.66rem / 2);margin-top:calc(1.66rem / 2);}li > ul{margin-left:1.66rem;margin-bottom:calc(1.66rem / 2);margin-top:calc(1.66rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.66rem / 2);}code{font-size:0.85rem;line-height:1.66rem;}kbd{font-size:0.85rem;line-height:1.66rem;}samp{font-size:0.85rem;line-height:1.66rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.10667rem;padding-right:1.10667rem;padding-top:0.83rem;padding-bottom:calc(0.83rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}</style><link href="//fonts.googleapis.com/css?family=Bitter:700|Open+Sans:400" rel="stylesheet" type="text/css"/><link rel="shortcut icon" href="/icons/icon-48x48.png"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#3498DB"/><link as="script" rel="preload" href="/component---src-templates-post-tsx-2d354d5006db6f740ef5.js"/><link as="script" rel="preload" href="/0-f52d6319582faf329931.js"/><link as="script" rel="preload" href="/app-e4e00972235f5e6128e9.js"/><link as="script" rel="preload" href="/webpack-runtime-16cce78ea2943f900d95.js"/><link rel="preload" href="/static/d/194/path---blog-react-new-context-api-62-b-38e-DM8TvIuGJAKXX4XalENxrrjAyxk.json" as="fetch" crossOrigin="use-credentials"/></head><body><noscript><iframe
  src="https://www.googletagmanager.com/ns.html?id=GTM-MVP42QK"
  height="0"
  width="0"
  style="display: none; visibility: hidden"
></iframe></noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><header class="Header__HeaderWrapper-sc-1pk7kz9-0 fMlwmL"><div class="Header__Content-sc-1pk7kz9-1 llYXYs"><a href="/">Typescript Power Blog</a><div class="SectionTitle-sc-6i07is-0 jykKLt">React âš›ï¸ æ–°çš„ Context API [è½¬è½½]</div><div class="Subline-sc-1don4fe-0 fQIQbK">2018.12.15<!-- --> â€” <!-- -->6<!-- --> Min Read â€” In<!-- --> <a href="/categories/react">React</a></div></div></header><div class="Wrapper-eqkv0y-0 hQYvCd"><div class="Content-b9laau-0 gZRmtj"><div class="Post__PostContent-yg6lty-0 cXzBXX"><p><em>è½¬è½½è‡ª<a href="https://fengshangwuqi.github.io" target="_blank" rel="nofollow noopener noreferrer">æ«ä¸Šé›¾æ£‹</a>çš„åšå®¢</em></p>
<p><em><a href="https://fengshangwuqi.github.io/2018-02-01-react-xin-de-context-api" target="_blank" rel="nofollow noopener noreferrer">React âš›ï¸ æ–°çš„ Context API</a></em></p>
<hr>
<p>åŸæ–‡åœ°å€ï¼š<a href="https://blog.kentcdodds.com/reacts-%EF%B8%8F-new-context-api-70c9fe01596b" target="_blank" rel="nofollow noopener noreferrer">React's âš›ï¸ new Context API</a>
ä½œè€…ï¼škentcdodds</p>
<p>è¿™ä¸å†æ˜¯ä¸€ä¸ª <strong>å®éªŒæ€§çš„ API</strong>ï¼Œå¹¶ä¸”å®ƒæ›´ç¬¦åˆå·¥ç¨‹åŒ–çš„ç†å¿µï¼Œç›®å‰å®ƒå·²æˆä¸º <strong>React ä¸€çº§æ£’çš„ API</strong>ã€‚</p>
<blockquote>
<p>âš ï¸ ï¼šå¤§å®¶å¯ä»¥é€šè¿‡ <a href="https://tinyletter.com/kentcdodds" target="_blank" rel="nofollow noopener noreferrer">newsletter</a> è·å–æˆ‘æœ€æ–°çš„èµ„è®¯ï¼Œæˆ‘ä¸€èˆ¬æ¯ä¸¤å‘¨é€šè¿‡é‚®ä»¶å‘é€ä¸€æ¬¡ï¼Œå¤§å®¶å¯ä»¥é€šè¿‡è‡ªå·±çš„æ”¶ä»¶ç®±è·å–æ›´å¤šçš„å†…å®¹ã€‚</p>
</blockquote>
<p><strong>React</strong> ä¸­çš„ <strong>context API</strong> ç›¸ä¿¡å¤§å®¶éƒ½çŸ¥é“å§ï¼Œå¯èƒ½è·Ÿå¤§ä¼™ä¸€æ ·ï¼Œå½“çœ‹åˆ° <strong>React</strong> çš„å®˜æ–¹æ–‡æ¡£æ˜¯è¿™æ ·æ—¶ï¼Œéƒ½ä¸æ•¢ç›´æ¥ä½¿ç”¨å®ƒã€‚</p>
<p><img src="./images/API.png" alt="API"></p>
<p>ç¬¬ä¸€æ¡æœç´¢ç»“æœæ˜¾ç¤ºçš„å°±æ˜¯ <a href="https://reactjs.org/docs/context.html#why-not-to-use-context" target="_blank" rel="nofollow noopener noreferrer">ä¸ºä»€ä¹ˆä¸å»ºè®®ä½¿ç”¨ context</a>ï¼Œè®©å¤§å®¶ç¬é—´äº§ç”Ÿå¿§è™‘ï¼Œè¯¥ç« èŠ‚æ˜¯è¿™ä¹ˆæè¿° <strong>context</strong> çš„ï¼š</p>
<blockquote>
<p>å¦‚æœä½ æƒ³è®©ä½ çš„åº”ç”¨æ›´åŠ ç¨³å®šï¼Œå°±åˆ«ä½¿ç”¨ <strong>context</strong>ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ª <strong>å®éªŒæ€§çš„ API</strong>ï¼Œåœ¨æœªæ¥çš„ <strong>React</strong> ç‰ˆæœ¬ä¸­å¯èƒ½ä¼šå‘ç”Ÿæ”¹å˜ã€‚</p>
</blockquote>
<p>âš ï¸ æ³¨æ„ï¼Œè¿™é‡Œçš„æ”¹å˜åŒ…å«ä¸­æ–­ï¼Œç»ˆæ­¢ï¼Œä¸å†ä½¿ç”¨ã€‚</p>
<h2 id="é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆè¿˜è¦ä½¿ç”¨-context-å‘¢"><a href="#%E9%82%A3%E4%B9%88%EF%BC%8C%E4%B8%BA%E4%BB%80%E4%B9%88%E8%BF%98%E8%A6%81%E4%BD%BF%E7%94%A8-context-%E5%91%A2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆè¿˜è¦ä½¿ç”¨ context å‘¢</h2>
<p>ä½ æ›¾ç»å†è¿‡å°è¯•åœ¨ä¸€ä¸ªå±‚çº§å¾ˆæ·±çš„ç»„ä»¶ä¸­è·å–æœ€å¤–å±‚ç»„ä»¶çš„ <strong>state</strong> çš„ç—›è‹¦ä¹ˆï¼Œè¿™ç§ç—›è‹¦å« <strong>prop drilling</strong>ï¼Œå¯è°“è®©äººæ¥è¿‘å´©æºƒçš„ã€‚å½“é‡åˆ°è¿™ç§æƒ…å½¢æ—¶ï¼Œä½ è‚¯å®šä¸ä¼šå–œæ¬¢ç”¨ <strong>props</strong> æ¥ä¼ é€’æ•°æ®ï¼Œå› ä¸ºå¦‚æœä¸­é—´æœ‰ä¸ªç»„ä»¶å‘ç”Ÿæ”¹å˜ï¼Œè¿™ä¸ªä»£ä»·å°†æ˜¯å‡ ä½• :joy:ã€‚</p>
<p>å®é™…ä¸Šï¼Œä½ å¯ä»¥é€šè¿‡ä½¿ç”¨å¸¸è§„çš„ <strong>JavaScript module</strong> æ¥è§„é¿ä»¥ä¸Šçš„é—®é¢˜ï¼Œå°†æ•°æ®å­˜åœ¨æŸä¸ª <strong>module</strong> ä¸­ï¼Œå°±å¯ä»¥å®ç°åœ¨ä»»ä½•åœ°æ–¹è®¿é—®å’Œå¯¼å…¥äº†ï¼Œä½†è¿™ä¹ˆåšä¼šè®©æ›´æ–°å˜å¾—å›°éš¾ï¼ˆä½ å¿…é¡»å®ç°ä¸€ä¸ª <strong>event</strong> åœ¨æ•°æ®æ›´æ–°æ—¶è§¦å‘ï¼Œé€šçŸ¥ç”¨æˆ·æ•°æ®å‘ç”Ÿæ”¹å˜ï¼‰ï¼Œå¹¶ä¸”ï¼ŒæœåŠ¡ç«¯æ¸²æŸ“å¯¹ <strong>module</strong> ä¹Ÿä¼šæœ‰ <a href="https://stackoverflow.com/questions/40935571/why-singleton-store-in-flux-can-cause-issue-for-server-side-rendering/40974748#40974748" target="_blank" rel="nofollow noopener noreferrer">å½±å“</a>ã€‚</p>
<p>å› æ­¤ï¼Œåƒ <a href="https://redux.js.org/" target="_blank" rel="nofollow noopener noreferrer">redux</a> è¿™æ ·çš„è´Ÿè´£ <strong>çŠ¶æ€ç®¡ç†</strong> çš„ç¬¬ä¸‰æ–¹åº“è¿›å…¥äº†å¤§å®¶çš„è§†é‡ã€‚å®ƒå…è®¸ä½ åœ¨ä»»ä½•åœ°æ–¹ä» <strong>store</strong> è·å–æ•°æ®ï¼Œä½ éœ€è¦åšçš„åªæ˜¯ä½¿ç”¨ <strong>Provider</strong> åŒ…è£…ä¸€ä¸‹ï¼Œç„¶åå°±å¯ä»¥ç¥å¥‡åœ°åœ¨ <strong>connected</strong> çš„ç»„ä»¶ä¸­è½»æ¾åœ°è·å–æƒ³è¦çš„æ•°æ®äº†ã€‚</p>
<p>ç„¶è€Œï¼Œå¦‚æœæˆ‘å‘Šè¯‰ä½  <strong>Provider</strong> å°±æ˜¯åœ¨ä½¿ç”¨ <strong>context</strong> è¿™ä¸ª <strong>å®éªŒæ€§ API</strong> å‘¢ï¼ŸğŸ˜± äº‹å®ç¡®å®æ˜¯è¿™æ ·çš„ï¼<strong>provider</strong> ç»„ä»¶å°†æ•°æ®å­˜è¿› <strong>context</strong> ä¸­ï¼Œ<strong>connect</strong> é«˜é˜¶ç»„ä»¶ä» <strong>context</strong> è·å–æ•°æ®ï¼Œæ‰€ä»¥ï¼Œ<strong>redux</strong> äº‹å®å¹¶ä¸å…è®¸ä½ çš„æ•°æ®åœ¨ä»»ä½•åœ°æ–¹è®¿é—®ã€‚</p>
<p>é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆè¿˜è¦ä½¿ç”¨ <strong>context</strong> å‘¢ï¼Ÿå¯èƒ½æ˜¯å¤§å®¶å·²ç»æ·±æ·±åœ°çˆ±ä¸Šå®ƒäº†å§ï¼å³ä½¿ä½ æ²¡æœ‰ç›´æ¥ä½¿ç”¨ <strong>context</strong>ï¼Œä½ çš„åº”ç”¨ç¨‹åºä¹Ÿä¼šé€šè¿‡å¼•ç”¨åƒ <a href="https://github.com/reactjs/react-redux/blob/76dd7faa90981dd2f9efa76f3e2f26ecf2c12cf7/src/components/connectAdvanced.js#L136-L143" target="_blank" rel="nofollow noopener noreferrer">react-redux</a>ï¼Œ <a href="https://github.com/mobxjs/mobx-react/blob/dc249910c74c1b2e988a879be07f10aeaea90936/src/Provider.js#L19-L34" target="_blank" rel="nofollow noopener noreferrer">MobX-react</a>ï¼Œ <a href="https://github.com/ReactTraining/react-router/blob/e6f9017c947b3ae49affa24cc320d0a86f765b55/packages/react-router/modules/Router.js#L23-L34" target="_blank" rel="nofollow noopener noreferrer">react-router</a>ï¼Œ <a href="https://github.com/paypal/glamorous/blob/7468bfc76f46783cac841e20973ed119c771f3b7/src/theme-provider.js#L33-L37" target="_blank" rel="nofollow noopener noreferrer">glamorous</a> è¿™æ ·çš„ç¬¬ä¸‰æ–¹åº“é—´æ¥ç”¨åˆ°å®ƒã€‚</p>
<h2 id="context-é‡ç”Ÿå•¦"><a href="#context-%E9%87%8D%E7%94%9F%E5%95%A6" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Context é‡ç”Ÿå•¦</h2>
<p>ç°åœ¨æ¸…æ¥šäº†ï¼Œæˆ‘ä»¬æ˜¯å¦‚æ­¤åœ°çƒ­çˆ± <strong>context</strong>ï¼Œä½†å®˜æ–¹æ–‡æ¡£çš„è­¦å‘Šä¾ç„¶è¿˜åœ¨ï¼šåœ¨ <strong>React</strong> çš„æœªæ¥ç‰ˆæœ¬ä¸­ï¼Œå¯èƒ½ä¸å†ä½¿ç”¨å®ƒï¼Œå¥½æ¶ˆæ¯æ˜¯ï¼Œ<strong>context</strong> è¦æ­£å¼è·Ÿå¤§å®¶æ‰“æ‹›å‘¼äº†ï¼Œè€Œä¸”å¤§å®¶å¯èƒ½ä¼šæ¯”ä¹‹å‰æ›´çˆ±å®ƒã€‚</p>
<p>ä¸€ä¸ªæœˆå‰ï¼Œ<strong>React</strong> å›¢é˜Ÿ ä» <a href="https://github.com/yarnpkg/rfcs" target="_blank" rel="nofollow noopener noreferrer">yarn</a>ï¼Œ<a href="https://github.com/rust-lang/rfcs" target="_blank" rel="nofollow noopener noreferrer">rust</a> å’Œ <a href="https://github.com/emberjs/rfcs" target="_blank" rel="nofollow noopener noreferrer">Ember</a> çš„ <strong>rfcs ä»“åº“</strong> å—åˆ°å¯å‘ï¼Œå»ºç«‹äº†ä¸€ä¸ªè‡ªå·±çš„ <a href="https://github.com/reactjs/rfcs" target="_blank" rel="nofollow noopener noreferrer">rfcs</a> ä»“åº“ã€‚ä»“åº“ç¬¬ä¸€ä¸ª <strong>PR</strong> æ¥è‡ª <a href="https://twitter.com/acdlite" target="_blank" rel="nofollow noopener noreferrer">Andrew Clark</a>ï¼ˆReact å›¢é˜Ÿæ ¸å¿ƒæˆå‘˜ï¼‰ï¼Œ<strong>PR</strong> æ ‡é¢˜ä¸º <a href="https://github.com/reactjs/rfcs/pull/2" target="_blank" rel="nofollow noopener noreferrer">New version of context</a>ï¼Œå…¶ä¸­ <strong>Andrew Clark</strong> æ¦‚è¿°äº†æœªæ¥æ–°ç‰ˆæœ¬çš„ <strong>context</strong> æ˜¯æ€æ ·çš„ï¼Œä¹‹åè¿˜å­˜åœ¨ä¸€äº›æœ‰è¶£çš„è®¨è®ºï¼Œå‡ å¤©åï¼Œ<strong>Andrew Clark</strong> å°±å‘ <strong>React</strong> ä»“åº“æäº†ä¸€ä¸ª <a href="https://github.com/facebook/react/pull/11818" target="_blank" rel="nofollow noopener noreferrer">New context API</a> çš„ <strong>PR</strong>ã€‚</p>
<p>é‚£ä¹ˆï¼Œåˆ°åº•æœ‰ä»€ä¹ˆæ”¹å˜å‘¢ï¼Ÿæ®è‚‰çœ¼ä¼°è®¡ï¼Œæ–°çš„ <strong>API</strong> ä¸ä¹‹å‰çš„ <strong>API</strong> å­˜åœ¨ç™¾ä¸‡çº§åˆ«çš„å·®å¼‚ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ <a href="https://codesandbox.io/s/n4r0qq898j?from-embed" target="_blank" rel="nofollow noopener noreferrer">ç¤ºä¾‹</a>ï¼š</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> ThemeContext <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token string">"light"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">ThemeProvider</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span> theme<span class="token punctuation">:</span> <span class="token string">"light"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> ThemeContext<span class="token punctuation">.</span><span class="token function">provide</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>theme<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">ThemeConsumer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> children <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> ThemeContext<span class="token punctuation">.</span><span class="token function">consume</span><span class="token punctuation">(</span>children<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">&lt;</span>ThemeProvider<span class="token operator">></span>
      <span class="token operator">&lt;</span>ThemeConsumer<span class="token operator">></span><span class="token punctuation">{</span>val <span class="token operator">=></span> <span class="token operator">&lt;</span>div<span class="token operator">></span><span class="token punctuation">{</span>val<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>ThemeConsumer<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>ThemeProvider<span class="token operator">></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<blockquote>
<p>ä½ å¯èƒ½æ³¨æ„åˆ°ç¤ºä¾‹ä¸­ä½¿ç”¨åˆ°ä¸€ä¸ª <strong>render prop</strong>ï¼Œä½†å®é™…ä¸Šå¹¶æ²¡æœ‰ä»»ä½•å…³äºéœ€è¦ä½¿ç”¨ <strong>render prop</strong> çš„ <strong>context API</strong>ï¼Œä½ å¯ä»¥ä½¿ç”¨ <strong>context API</strong> è½»æ¾å®ç°é«˜é˜¶ç»„ä»¶æˆ–å…¶ä»–åŠŸèƒ½ã€‚</p>
</blockquote>
<p>æ–°çš„ <strong>context API</strong> ä¸»è¦ç”±ä»¥ä¸‹ä¸‰éƒ¨åˆ†ç»„æˆï¼š</p>
<ul>
<li><strong>React.createContext</strong>ï¼šç”¨äºä¼ é€’åˆå§‹å€¼ï¼Œè¿”å›ä¸€ä¸ªåŒ…å« <strong>provider</strong> å’Œ <strong>consumer</strong> çš„å¯¹è±¡ï¼›</li>
<li><strong>provide</strong>ï¼šæ”¾ç½®åœ¨ç»„ä»¶æ ‘ä¸­çš„è¾ƒé«˜å±‚ï¼Œå¹¶å¯ä»¥æ¥æ”¶ä»»ä½•å€¼ï¼›</li>
<li><strong>consume</strong>ï¼šåœ¨ <strong>provider</strong> ä¹‹åä»»ä½•åœ°æ–¹ä½¿ç”¨ï¼Œå¹¶ä¼ é€’ä¸€ä¸ªè¿”å› <strong>JSX</strong> çš„å‡½æ•°ï¼ˆè¿™æœ‰ç‚¹åƒ <strong>render prop</strong> ç»„ä»¶ï¼Œä½† <strong>consume</strong> ä¸æ˜¯ç»„ä»¶ï¼‰ï¼›</li>
</ul>
<p>æˆ‘å¯¹è¿™ä¸ª <strong>API</strong> å……æ»¡äº†æœŸå¾…ï¼Œ<strong>React</strong> å›¢é˜Ÿä¹Ÿå°†ä¼šç§»é™¤ <strong>context æ˜¯å®éªŒæ€§ API</strong> çš„è­¦å‘Šï¼Œå› ä¸ºå®ƒç°åœ¨æ˜¯æ¡†æ¶ <a href="https://twitter.com/acdlite/status/957445801302618112" target="_blank" rel="nofollow noopener noreferrer">ä¸€çº§æ£’çš„ç‰¹æ€§</a>ï¼Œè¿™ä¹Ÿæ„å‘³ç€å¤§å®¶å°†ä¸å†é‚£ä¹ˆæ‹…å¿ƒä½¿ç”¨ <strong>context</strong> æ¥è§£å†³åº”ç”¨ä¸­ <strong>prop-drilling</strong> çš„é—®é¢˜äº†ï¼Œå¯¹ <strong>Redux</strong> ä¸å†é‚£ä¹ˆä¾èµ–ï¼Œå¯¹ <strong>React</strong> ä¹Ÿå°†æ›´åŠ å–œæ¬¢ã€‚</p>
<p>è¿™æ˜¯æˆ‘æœ€è¿‘çš„æ¨æ–‡ï¼š</p>
<div class="twitter-content">
	<blockquote class="twitter-tweet" data-lang="zh-cn"><p lang="en" dir="ltr">People&#39;s fixation with keeping render methods small aggravates the &quot;prop drilling problem&quot; which makes folks want redux to help alleviate it</p>&mdash; Kent C. Dodds (@kentcdodds) <a href="https://twitter.com/kentcdodds/status/911276059051438082?ref_src=twsrc%5Etfw">2017å¹´9æœˆ22æ—¥</a></blockquote>
</div>
<p>æˆ‘è®¤ä¸ºå¦‚æœæˆ‘ä»¬ä¸è¿‡æ—©æˆ–æ­¦æ–­åœ°å»ç ´å <strong>render</strong> æ–¹æ³•ï¼Œæˆ‘ä»¬å¯èƒ½å°±ä¸ä¼šé‚£ä¹ˆç—›è‹¦ï¼Œå³ä¾¿æœ€ç»ˆæˆ‘ä»¬å®åœ¨æ²¡æœ‰åŠæ³•é¿å…ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡æ ¸å¿ƒçš„ <strong>React API</strong> æ¥è§£å†³ã€‚</p>
<h2 id="context-å®è·µ"><a href="#context-%E5%AE%9E%E8%B7%B5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Context å®è·µ</h2>
<p>æˆ‘çœ‹åˆ°äº†ä¸€ä¸ªå…³äº <strong>context API</strong>ï¼ˆæˆ–æ™®é€šçš„ <strong>render prop pattern</strong>ï¼‰çš„é—®é¢˜å¾ˆå¤šæ¬¡ï¼Œå°±æ˜¯å¦‚ä½•ç»„åˆ <strong>providers</strong> å’Œ <strong>consumers</strong>ï¼Œå½“åœ¨ä¸€ä¸ª <strong>render</strong> æ–¹æ³•ä¸­æŠŠä¸€å † <strong>render prop</strong> ç»„ä»¶æ”¾åœ¨ä¸€èµ·æ—¶ï¼Œå°±ä¼šåƒè¿™æ · <a href="https://twitter.com/acdlite/status/955955121979969537" target="_blank" rel="nofollow noopener noreferrer">åµŒå¥—</a>ã€‚</p>
<div class="twitter-content">
	<blockquote class="twitter-tweet" data-conversation="none" data-lang="zh-cn"><p lang="en" dir="ltr">I mean come on (screen shot of actual code Iâ€™m playing with right now) <a href="https://t.co/Ucc8gaxPMp">pic.twitter.com/Ucc8gaxPMp</a></p>&mdash; Andrew Clark (@acdlite) <a href="https://twitter.com/acdlite/status/955955121979969537?ref_src=twsrc%5Etfw">2018å¹´1æœˆ24æ—¥</a></blockquote>
</div>
<p>é‚£ä¹ˆï¼Œæˆ‘ä»¬å¯ä»¥åšç‚¹ä»€ä¹ˆæ¥é¿å…å‘¢ï¼Ÿå…¶å®ï¼Œä¸ªäººè§‰å¾—æ²¡æœ‰é‚£ä¹ˆç³Ÿç³•ï¼Œå¦‚æœä½ è§‰å¾—è¿™æ ·å¹¶ä¸å¥½ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨å¸¸è§„çš„ <strong>utility</strong> å‡½æ•°/ç»„ä»¶æ¥è§£å†³ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼š</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> ThemeContext <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token string">"light"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">ThemeProvider</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token comment">/* code */</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">ThemeConsumer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> children <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> ThemeContext<span class="token punctuation">.</span><span class="token function">consume</span><span class="token punctuation">(</span>children<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> LanguageContext <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token string">"en"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">LanguageProvider</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token comment">/* code */</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">LanguageConsumer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> children <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> LanguageContext<span class="token punctuation">.</span><span class="token function">consume</span><span class="token punctuation">(</span>children<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">AppProviders</span><span class="token punctuation">(</span><span class="token punctuation">{</span> children <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>LanguageProvider<span class="token operator">></span>
      <span class="token operator">&lt;</span>ThemeProvider<span class="token operator">></span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>ThemeProvider<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>LanguageProvider<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">ThemeAndLanguageConsumer</span><span class="token punctuation">(</span><span class="token punctuation">{</span> children <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>LanguageConsumer<span class="token operator">></span>
      <span class="token punctuation">{</span>language <span class="token operator">=></span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>ThemeConsumer<span class="token operator">></span><span class="token punctuation">{</span>theme <span class="token operator">=></span> <span class="token function">children</span><span class="token punctuation">(</span><span class="token punctuation">{</span> language<span class="token punctuation">,</span> theme <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>ThemeConsumer<span class="token operator">></span>
      <span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>LanguageConsumer<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">&lt;</span>AppProviders<span class="token operator">></span>
      <span class="token operator">&lt;</span>ThemeAndLanguageConsumer<span class="token operator">></span>
        <span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">{</span> theme<span class="token punctuation">,</span> language <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>
          <span class="token operator">&lt;</span>div<span class="token operator">></span>
            <span class="token punctuation">{</span>theme<span class="token punctuation">}</span> and <span class="token punctuation">{</span>language<span class="token punctuation">}</span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
        <span class="token punctuation">)</span><span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>ThemeAndLanguageConsumer<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>AppProviders<span class="token operator">></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>ç›®æ ‡æ˜¯ä½¿ç”¨å¸¸è§çš„æ¡ˆä¾‹ï¼Œç»“åˆç‰¹æ®ŠåŠŸèƒ½çš„å‡½æ•°/ç»„ä»¶ï¼Œä½¿æ¡ˆä¾‹æ›´åŠ å·¥ç¨‹åŒ–ã€‚</p>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œå¤§å®¶è¿˜å¯ä»¥å‚è€ƒ <a href="https://medium.com/@jmeas" target="_blank" rel="nofollow noopener noreferrer">jmeas</a> çš„ <a href="https://codesandbox.io/s/92pj14134y?from-embed" target="_blank" rel="nofollow noopener noreferrer">react-composer</a>ã€‚</p>
<p>åœ¨è¿™é‡Œéœ€è¦æåŠçš„æ˜¯ï¼Œåœ¨å®è·µä¸­ï¼Œå¹¶ä¸å»ºè®®å¤§å®¶åµŒå¥—æ¸²æŸ“ <strong>props components</strong>ï¼Œæ— è®ºä»€ä¹ˆæ—¶å€™ï¼Œéƒ½å¯ä»¥é€‰æ‹©åˆ›å»ºå¤šä¸ªç®€å•æ˜“ç”¨çš„ç»„ä»¶ï¼Œç„¶åç»„åˆä½¿ç”¨ã€‚</p>
<h2 id="æ€»ç»“"><a href="#%E6%80%BB%E7%BB%93" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>æ€»ç»“</h2>
<p>æ­£å¦‚ä¸Šé¢æ‰€è¯´çš„ï¼Œæˆ‘å¯¹è¿™ä¸ª <strong>API</strong> å……æ»¡äº†æœŸå¾…ã€‚ç›®å‰æš‚æœªå‘å¸ƒï¼Œä½†åº”è¯¥ä¼šåŒ…å«åœ¨ä¸‹ä¸€ä¸ª <strong>minor</strong> ç‰ˆæœ¬ä¸­ã€‚ä¸åŒæ‹…å¿ƒï¼Œä¹‹å‰çš„ <strong>API</strong> ä¼šç»§ç»­æ­£å¸¸å·¥ä½œï¼Œç›´åˆ°ä¸‹ä¸€ä¸ª <strong>major</strong> ç‰ˆæœ¬å‘å¸ƒï¼Œæ‰€ä»¥ï¼Œæ¯ä¸ªäººéƒ½æœ‰æ—¶é—´è¿ç§»ï¼Œè€Œä¸”ä¸ç”¨è¿‡äºæ‹…å¿ƒï¼Œ<strong>React</strong> å›¢é˜Ÿåœ¨ <strong>Facebook</strong> æœ‰è¶…è¿‡ <strong>50,000</strong> ä¸ª <strong>React components</strong> éœ€è¦ç»´æŠ¤ï¼Œæ‰€ä»¥ï¼Œå°†æ¥å¾ˆæœ‰å¯èƒ½ä¼šå‘å¸ƒä¸€ä¸ª <strong>codemod</strong> å»è‡ªåŠ¨æ›´æ–°å¤§å¤šæ•°äººçš„ä»£ç ï¼ˆå°±åƒä»¥å¾€ä¸€æ ·ï¼‰ã€‚</p>
<p>æœ€åå†è¡¨è¾¾ä¸€ä¸‹æˆ‘å¯¹æ­¤çš„å…´å¥‹ã€‚</p>
<div class="twitter-content">
	<blockquote class="twitter-tweet" data-conversation="none" data-lang="zh-cn"><p lang="en" dir="ltr">That&#39;s one thing that excites me about the API improvement (in addition to other changes coming). So many new patterns will emerge out of this stuff. Ways of doing things we haven&#39;t considered before!!</p>&mdash; Kent C. Dodds (@kentcdodds) <a href="https://twitter.com/kentcdodds/status/956675313966239745?ref_src=twsrc%5Etfw">2018å¹´1æœˆ25æ—¥</a></blockquote>
</div>
<hr>
<p>æœ¬æ–‡é“¾æ¥ï¼š<a href="https://samualle.github.io/blog/react-new-context-api" target="_blank" rel="nofollow noopener noreferrer">React âš›ï¸ æ–°çš„ Context API</a></p></div><div class="Subline-sc-1don4fe-0 eUvCXN">Tags: Â <a href="/tags/technology"><strong>Technology</strong> <!-- -->, </a><a href="/tags/react"><strong>React</strong> </a></div><div class="PrevNext__Wrapper-sc-1ndbygb-0 cLXdVi"><div class="PrevNext__Prev-sc-1ndbygb-1 flGCNf"><span>ä¸Šä¸€ç¯‡</span><a href="/blog/coding-is-very-fun-is-not-it">Coding is very fun, isn&#x27;t it?</a></div></div></div></div><footer class="Layout__Footer-sc-1dswc3f-0 fVFvrD">Â© <!-- -->15<!-- --> by Samuel Wong. All rights reserved. <br/><a href="https://github.com/samualle/samualle.github.io">GitHub Repository</a> <br/><span>Last build: <!-- -->2018.12.15</span></footer></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-post-tsx","jsonName":"blog-react-new-context-api-62b","path":"/blog/react-new-context-api"};window.dataPath="194/path---blog-react-new-context-api-62-b-38e-DM8TvIuGJAKXX4XalENxrrjAyxk";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-e4e00972235f5e6128e9.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-6343b08ae213af306e85.js"],"component---src-templates-blog-tsx":["/component---src-templates-blog-tsx.0e4338761429b4eb16ac.css","/component---src-templates-blog-tsx-160b90b1e5328f15cf69.js"],"component---src-templates-all-category-tsx":["/component---src-templates-all-category-tsx.0e4338761429b4eb16ac.css","/component---src-templates-all-category-tsx-54e9d7d5b60a0f1847ef.js"],"component---src-templates-category-tsx":["/component---src-templates-category-tsx.0e4338761429b4eb16ac.css","/component---src-templates-category-tsx-4bb7b1b109ca98cd5c5c.js"],"component---src-templates-all-tag-tsx":["/component---src-templates-all-tag-tsx.0e4338761429b4eb16ac.css","/component---src-templates-all-tag-tsx-fa8e8a89164d05a62369.js"],"component---src-templates-tag-tsx":["/component---src-templates-tag-tsx.0e4338761429b4eb16ac.css","/component---src-templates-tag-tsx-cf2bed38f2a3a250f6ce.js"],"component---src-templates-post-tsx":["/component---src-templates-post-tsx.a3f47ba95bfcb7ece2a3.css","/component---src-templates-post-tsx-2d354d5006db6f740ef5.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx.0e4338761429b4eb16ac.css","/component---src-pages-404-tsx-de1b2c88d14c6b55d9da.js"],"component---src-pages-contact-tsx":["/component---src-pages-contact-tsx.0e4338761429b4eb16ac.css","/component---src-pages-contact-tsx-bed7a6eb7fe54305272e.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx.0e4338761429b4eb16ac.css","/component---src-pages-index-tsx-a3cfff9c0a52c39c336d.js"]};/*]]>*/</script><script src="/webpack-runtime-16cce78ea2943f900d95.js" async=""></script><script src="/app-e4e00972235f5e6128e9.js" async=""></script><script src="/0-f52d6319582faf329931.js" async=""></script><script src="/component---src-templates-post-tsx-2d354d5006db6f740ef5.js" async=""></script></body></html>